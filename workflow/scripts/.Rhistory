library(VariantAnnotation)
library(VariantAnnotation)
indexVcf('../dir_output_selected/variant_calling/SRR12881620.vcf.gz')
library(VariantAnnotation)
indexVcf('../dir_output_selected/variant_calling/SRR12881620.vcf.gz')
result <- indexVcf('../dir_output_selected/variant_calling/SRR12881620.vcf.gz')
result
class(result)
str(result)
result$index
indexVcf(paste(snakemake@input[[1]]))$index
indexVcf(paste(snakemake@input[[1]]))
indexVcf('../dir_output_selected/variant_calling/SRR12881620.vcf.gz')$index
vcfpath <- c('../dir_output_selected/variant_calling/SRR12881620.vcf.gz')
index <- indexVcf(vcfpath)
index
index$index
library(VariantAnnotation)
index <- indexVcf('../dir_output_selected/variant_calling/SRR12881620.vcf.gz')
index
index$path
help(bgzip)
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
library(Biostrings)
library(GenomicAlignments)
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
preconsensus
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
preconsensus
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')[[1]]
preconsensus
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
names(preconsensus)
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
aln <- readGAlignments(snakemake@input[[0]])
coverage <- as.numeric(coverage(aln)[[1]])
consensus <- DNAStringSet(replaceLetterAt(preconsensus, which(coverage<10), rep('N',length(which(coverage<10)))))
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
consensus <- DNAStringSet(replaceLetterAt(preconsensus, which(coverage<10), rep('N',length(which(coverage<10)))))
coverage
consensus <- DNAStringSet(replaceLetterAt(preconsensus[[1]], which(coverage<10), rep('N',length(which(coverage<10)))))
preconsensus[[1]]
coverage
which(coverage<10)
replaceLetterAt(preconsensus[[1]], which(coverage<10), rep('N',length(which(coverage<10))))
preconsensus[[1]]
which(coverage<10)
length(which(coverage<10))
DNAStringSet(replaceLetterAt(preconsensus[[1]], which(coverage<100), rep('N',length(which(coverage<100)))))
length(which(coverage<100))
length(which(coverage<1000))
coverage
preconsensus
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
coverage
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
consensus <- DNAStringSet(replaceLetterAt(preconsensus[[1]], which(coverage<10), rep('N',length(which(coverage<10)))))
ref_fasta <- readDNAStringSet('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/00-reference-genome/nCoV-2019.reference.fasta')
ref_fasta
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
preconsensus
aln <- readGAlignments('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/02_mapping/barcode01.sorted.bam')
cover <- as.numeric(coverage(aln)[[1]])
pre_consensus <- DNAStringSet(replaceLetterAt(ref_fasta[[1]], which(cover<10), rep('N',length(which(cover<10)))))
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
cover <- as.numeric(coverage(aln)[[1]])
consensus <- DNAStringSet(replaceLetterAt(preconsensus[[1]], which(cover<10), rep('N',length(which(cover<10)))))
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
cover <- as.numeric(coverage(aln)[[1]])
consensus <- DNAStringSet(replaceLetterAt(preconsensus[[1]], which(cover<10), rep('N',length(which(cover<10)))))
ref_fasta <- readDNAStringSet('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/00-reference-genome/nCoV-2019.reference.fasta')
aln <- readGAlignments('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/02_mapping/barcode01.sorted.bam')
cover <- as.numeric(coverage(aln)[[1]])
pre_consensus <- DNAStringSet(replaceLetterAt(ref_fasta[[1]], which(cover<10), rep('N',length(which(cover<10)))))
ref_fasta <- readDNAStringSet('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/00-reference-genome/nCoV-2019.reference.fasta')
aln <- readGAlignments('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/02_mapping/barcode01.sorted.bam')
cover <- as.numeric(coverage(aln)[[1]])
pre_consensus <- DNAStringSet(replaceLetterAt(ref_fasta[[1]], which(cover<10), rep('N',length(which(cover<10)))))
pre_consensus
aln <- readGAlignments('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/02_mapping/barcode01.sorted.bam')
aln
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
aln
aln <- readGAlignments('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/02_mapping/barcode01.sorted.bam')
cover <- as.numeric(coverage(aln)[[1]])
cover
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
cover <- as.numeric(coverage(aln)[[1]])
cover
ref_fasta <- readDNAStringSet('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/00-reference-genome/nCoV-2019.reference.fasta')
ref_fasta
preconsensus <- readDNAStringSet('../dir_output_selected/consensus/SRR12881620.preconsensus.fasta')
preconsensus
consensus <- DNAStringSet(replaceLetterAt(ref_fasta[[1]], which(cover<10), rep('N',length(which(cover<10)))))
reference <- readDNAStringSet('../reference_genome/nCoV-2019.reference.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
preconsensus <- DNAStringSet(replaceLetterAt(ref_fasta[[1]], which(coverage<10), rep('N',length(which(coverage<10)))))
reference <- readDNAStringSet('../reference_genome/nCoV-2019.reference.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
preconsensus <- DNAStringSet(replaceLetterAt(ref_fasta[[1]], which(coverage<10), rep('N',length(which(coverage<10)))))
names(preconsensus)
basename('../dir_output_selected/mapping/SRR12881620.sorted.bam')
preconsensus <- DNAStringSet(replaceLetterAt(ref_fasta[[1]], which(coverage<10), rep('N',length(which(coverage<10)))))
names(preconsensus) <- gsub(basename('../dir_output_selected/mapping/SRR12881620.sorted.bam'),pattern='.sorted.bam',replacement = '')
preconsensus
reference <- readDNAStringSet('../reference_genome/nCoV-2019.reference.fasta')
reference <- readDNAStringSet('../reference_genome/nCoV-2019.reference.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
preconsensus <- DNAStringSet(replaceLetterAt(reference, which(coverage<10), rep('N',length(which(coverage<10)))))
coverage
which(coverage<10)
reference
preconsensus <- DNAStringSet(replaceLetterAt(reference[1], which(coverage<10), rep('N',length(which(coverage<10)))))
aln <- readGAlignments('../../../28_CTMA_COVID_MOSTAFA/06_home_made_pipeline/02_mapping/barcode01.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
preconsensus <- DNAStringSet(replaceLetterAt(reference[1], which(coverage<10), rep('N',length(which(coverage<10)))))
preconsensus <- DNAStringSet(replaceLetterAt(reference[1], which(cover<10), rep('N',length(which(cover<10)))))
cover
reference
cover
preconsensus <- DNAStringSet(replaceLetterAt(reference[1], which(cover<10), rep('N',length(which(cover<10)))))
preconsensus <- DNAStringSet(replaceLetterAt(reference[1], which(cover<10), rep('N',length(which(cover<10)))))
length(cover)
preconsensus <- DNAStringSet(replaceLetterAt(reference[[1]], which(cover<10), rep('N',length(which(cover<10)))))
preconsensus <- DNAStringSet(replaceLetterAt(reference[[1]], which(coverage<10), rep('N',length(which(coverage<10)))))
reference <- readDNAStringSet('../reference_genome/nCoV-2019.reference.fasta')
aln <- readGAlignments('../dir_output_selected/mapping/SRR12881620.sorted.bam')
coverage <- as.numeric(coverage(aln)[[1]])
preconsensus <- DNAStringSet(replaceLetterAt(reference[[1]], which(coverage<10), rep('N',length(which(coverage<10)))))
